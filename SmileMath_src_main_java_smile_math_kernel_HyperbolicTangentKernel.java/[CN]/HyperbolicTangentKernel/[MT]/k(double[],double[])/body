{
  if (x.length != y.length)   throw new IllegalArgumentException(String.format("Arrays have different length: x[%d], y[%d]",x.length,y.length));
  double dot=Math.dot(x,y);
  return Math.tanh(scale * dot + offset);
}
