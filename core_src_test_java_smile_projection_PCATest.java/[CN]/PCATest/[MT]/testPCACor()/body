{
  System.out.println("learn");
  double[] prop={0.6200604,0.2474413,0.0891408,0.04335752};
  double[] cumprop={0.6200604,0.8675017,0.9566425,1.00000000};
  double[][] loadings={{0.124288601688222,-0.0969866877028367,0.0791404742697482,-0.150572299008293},{0.00706888610512014,-0.00227861130898090,0.00325028101296307,0.00901099154845273},{0.0194141494466002,0.060910660326921,0.0263806464184195,-0.0093429458365566},{0.0586084532558777,0.0180450999787168,-0.0881962972508558,-0.0096011588898465}};
  double[][] points={{0.985565884503144,-1.13339237770997,0.444268787550732,-0.156267144919713},{1.95013775033502,-1.07321325616848,-2.04000333289159,0.438583439947191},{1.76316353972298,0.745956780637292,-0.0547808243262835,0.834652924308098},{-0.141420289868355,-1.11979678418355,-0.114573691853362,0.182810896293142},{2.52398012651925,1.54293398865821,-0.598556798722446,0.341996477783837},{1.51456286110159,0.987555085168417,-1.09500699201534,-0.0014648870296938},{-1.35864745985436,1.08892789190617,0.643257568830491,0.118469414050217},{0.0477093090600237,0.3253589245946,0.71863294241999,0.88197763723111},{3.01304227028722,-0.0392285132807885,0.576829491848594,0.0962847520332607},{1.63928304283591,-1.27894240278142,0.3424600796425,-1.07679681203227},{-0.912657145897512,1.57046001204312,-0.0507818939319191,-0.902806863984286},{-1.63979985216349,-0.210972917376817,-0.259801342130002,0.499104100522827},{1.37891072442415,0.681841188954653,0.677495640922048,0.122021291627908},{-0.505461361080942,0.151562541804405,-0.228054838283107,-0.424665700407568},{-2.25364606966872,0.104054072521579,-0.164564315384798,-0.0175559157039462},{-0.796881121217601,0.270164704820617,-0.025553307209892,-0.206496427667729},{-0.750859074389294,-0.958440286366705,0.02836941697898,-0.670556671464597},{1.56481797641247,-0.871054655078877,0.783480358209198,-0.454728038190371},{-2.39682948807447,-0.376391575937656,0.0656823864057083,0.330459817138909},{1.76336938853140,-0.427655192047538,0.157250127177974,0.559069521095022},{-0.486166287394260,1.47449649688749,0.60949747567568,0.179598962611096},{2.10844115004569,0.155396818827412,-0.384868583991876,-0.102372018543760},{-1.69268181440212,0.632261250592135,-0.153070434379820,-0.0673168849653057},{0.99649445921525,-2.39379598664439,0.740808395101789,-0.215508013269186},{0.696787329465988,0.263354790336906,-0.377443826869025,-0.225824461162746},{-1.18545190586353,-0.536874371541416,-0.246889321125754,-0.123742226859455},{-1.26563654112436,0.193953729656433,-0.175573906434378,-0.0158928878025202},{2.87439453851442,0.775600196040531,-1.16338049470918,-0.314515475845171},{-2.3839154090396,0.0180822896942706,-0.0368553931656889,0.0331373375836163},{0.181566109647703,1.44950571194364,0.764453551161094,-0.243382699500097},{1.9800237544635,-0.142848780293863,-0.183692179512918,0.339533597231392},{1.68257737630865,0.82318414195383,0.643075093004148,0.0134843688860191},{1.12337860637185,-2.2280033765179,0.863571787545964,0.954381667489125},{-2.99222561501786,-0.599118824460499,-0.301277284941070,0.253987327309305},{-0.225965422407925,0.742238237131951,0.0311391215184618,-0.473915911390733},{-0.311782855015387,0.287854205686879,0.0153097921537548,-0.0103323207812122},{0.0591220767886587,0.541411453784999,-0.939832976852491,0.237780688081491},{-0.888415824070835,0.571100352318098,0.400628705942535,-0.359061123767106},{-0.8637720636083,1.49197842268991,1.36994569757369,0.613569429776366},{1.32072380381582,-1.93340466253643,0.300537789621535,0.131466684662569},{-1.98777483728934,-0.823343241027363,-0.389293329061627,0.109571764040277},{0.99974168446248,-0.86025130467328,-0.188082948982953,-0.652864290754125},{1.35513820680531,0.412480819056524,0.492068857988700,-0.643195491241997},{-0.55056526221282,1.47150460831626,-0.293728036771692,0.0823140470257147},{-2.80141174000027,-1.40228805517747,-0.841263094223904,0.144889913711331},{-0.0963349112360505,-0.199735289142919,-0.0117125418366046,-0.211370813194815},{-0.216903378616043,0.970124183070788,-0.624870937888577,0.220847793049801},{-2.10858540768249,-1.42484670300488,-0.104774671146442,-0.131908830683941},{-2.07971416891733,0.611268624320317,0.138864997675415,-0.184103743036707},{-0.629426663525205,-0.321012967465219,0.240659233693745,0.166651800709434}};
  PCA pca=new PCA(Math.clone(USArrests),true);
  pca.setProjection(4);
  assertTrue(Math.equals(prop,pca.getVarianceProportion(),1E-7));
  assertTrue(Math.equals(cumprop,pca.getCumulativeVarianceProportion(),1E-7));
  assertTrue(Math.equals(loadings,pca.getLoadings(),1E-7));
  assertTrue(Math.equals(points,pca.project(USArrests),1E-7));
}
