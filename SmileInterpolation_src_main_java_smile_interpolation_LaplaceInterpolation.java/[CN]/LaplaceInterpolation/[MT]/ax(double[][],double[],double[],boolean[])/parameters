double[][] matrix
double[] x
double[] r
boolean[] mask
